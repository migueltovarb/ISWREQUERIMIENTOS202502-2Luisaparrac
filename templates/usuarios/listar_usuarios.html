{% extends 'proyectos/base_proyectos.html' %}
{% load static %}

{% block extra_head %}
<style>
/* Tarjeta tabla envolvente */
.pm-card {
    background: #ffffff;
    border-radius: 18px;
    padding: 28px;
    box-shadow: 0 4px 25px rgba(0,0,0,0.06);
}

/* Títulos */
.pm-title {
    font-weight: 700;
    font-size: 28px;
}

/* Tabla estilizada */
.pm-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 10px;
}

.pm-table thead th {
    font-size: 14px;
    text-transform: uppercase;
    color: #6b7280;
    padding-bottom: 6px;
}

.pm-row {
    background: #f9fafb;
    border-radius: 14px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.05);
}

.pm-row td {
    padding: 18px 20px;
    vertical-align: middle;
    font-size: 15px;
}

/* Estado */
.pm-badge {
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 600;
    border-radius: 50px;
}

.pm-active {
    background: #e0fce5;
    color: #15803d;
}

.pm-inactive {
    background: #fee2e2;
    color: #b91c1c;
}

/* Acciones */
.pm-btn {
    padding: 6px 14px;
    font-size: 14px;
    border-radius: 10px;
}

.pm-edit {
    background: #3b82f6;
    color: white;
}

.pm-edit:hover {
    background: #1e40af;
}

.pm-delete {
    background: #ef4444;
    color: white;
}

.pm-delete:hover {
    background: #991b1b;
}

/* Botón crear */
.pm-create-btn {
    padding: 10px 22px;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
}

/* Avatar */
.pm-avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: #3b82f6;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    font-weight: 600;
}

.pm-user {
    display: flex;
    align-items: center;
}
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="pm-title">Usuarios</h2>
        <a class="btn btn-primary pm-create-btn" href="{% url 'usuarios:crear_usuario' %}">
            Crear usuario
        </a>
    </div>

    <div class="pm-card">

        <table class="pm-table">
            <thead>
                <tr>
                    <th style="width: 28%;">Nombre</th>
                    <th style="width: 28%;">Email</th>
                    <th style="width: 15%;">Rol</th>
                    <th style="width: 12%;">Estado</th>
                    <th style="width: 17%;">Acciones</th>
                </tr>
            </thead>

            <tbody>
            {% for u in page_obj.object_list %}
                <tr class="pm-row">
                    <td>
                        <div class="pm-user">
                            <div class="pm-avatar">
                                {{ u.nombre_completo|default:u.email|first|upper }}
                            </div>
                            {% if u.nombre_completo %}
                                {{ u.nombre_completo }}
                            {% else %}
                                {{ u.email }}
                            {% endif %}
                        </div>
                    </td>

                    <td>{{ u.email }}</td>

                    <td>{{ u.get_rol_display }}</td>

                    <td>
                        {% if u.is_active %}
                            <span class="pm-badge pm-active">Activo</span>
                        {% else %}
                            <span class="pm-badge pm-inactive">Inactivo</span>
                        {% endif %}
                    </td>

                    <td>
                        <a class="pm-btn pm-edit me-2"
                           href="{% url 'usuarios:editar_usuario' u.id %}">Editar</a>

                        <a class="pm-btn pm-delete"
                           href="{% url 'usuarios:eliminar_usuario' u.id %}">
                           Eliminar
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

        <!-- Paginación -->
        <nav class="mt-3">
            <ul class="pagination">
                {% if page_obj.has_previous %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Anterior</a>
                    </li>
                {% endif %}

                <li class="page-item disabled">
                    <span class="page-link">
                        Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
                    </span>
                </li>

                {% if page_obj.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.next_page_number }}">Siguiente</a>
                    </li>
                {% endif %}
            </ul>
        </nav>

    </div>
</div>
{% endblock %}
